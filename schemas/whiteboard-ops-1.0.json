{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://myvirtualtutor.com/schemas/whiteboard-ops-1.0.json",
  "type": "object",
  "required": ["type", "version", "board", "defaults", "ops"],
  "properties": {
    "type": { "const": "whiteboard.ops" },
    "version": { "type": "string", "pattern": "^1\\.0$" },
    "board": {
      "type": "object",
      "required": ["width", "height", "unit"],
      "properties": {
        "width": { "type": "integer", "minimum": 320, "maximum": 4096 },
        "height": { "type": "integer", "minimum": 240, "maximum": 2160 },
        "unit": { "type": "string", "enum": ["px"] },
        "background": { "type": "string" }
      },
      "additionalProperties": false
    },
    "defaults": {
      "type": "object",
      "properties": {
        "stroke": { "type": "string" },
        "strokeWidth": { "type": "number", "minimum": 0, "maximum": 20 },
        "fill": { "type": "string" },
        "fontFamily": { "type": "string" },
        "fontSize": { "type": "number", "minimum": 8, "maximum": 96 }
      },
      "additionalProperties": false
    },
    "ops": {
      "type": "array",
      "minItems": 1,
      "maxItems": 200,
      "items": { "$ref": "#/$defs/op" }
    }
  },
  "additionalProperties": false,
  "$defs": {
    "op": {
      "oneOf": [
        { "$ref": "#/$defs/clear" },
        { "$ref": "#/$defs/add" },
        { "$ref": "#/$defs/update" },
        { "$ref": "#/$defs/remove" }
      ]
    },
    "clear": {
      "type": "object",
      "required": ["op"],
      "properties": { "op": { "const": "clear" } },
      "additionalProperties": false
    },
    "remove": {
      "type": "object",
      "required": ["op", "id"],
      "properties": {
        "op": { "const": "remove" },
        "id": { "type": "string" }
      },
      "additionalProperties": false
    },
    "add": {
      "type": "object",
      "required": ["op", "id", "kind", "props"],
      "properties": {
        "op": { "const": "add" },
        "id": { "type": "string" },
        "kind": {
          "type": "string",
          "enum": ["text", "latex", "line", "rect", "circle", "fraction_bar", "number_line"]
        },
        "props": { "type": "object" }
      },
      "additionalProperties": false
    },
    "update": {
      "type": "object",
      "required": ["op", "id", "props"],
      "properties": {
        "op": { "const": "update" },
        "id": { "type": "string" },
        "props": { "type": "object" }
      },
      "additionalProperties": false
    }
  }
}
